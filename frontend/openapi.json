{
  "openapi": "3.1.0",
  "info": {
    "title": "Copenhagen Event Recommender API",
    "description": "AI-powered event recommendations for Copenhagen nightlife",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "http://127.0.0.1:8001",
      "description": "Local development server"
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "summary": "Health Check",
        "description": "Health check endpoint",
        "operationId": "health_check",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/": {
      "get": {
        "summary": "Root",
        "description": "Root endpoint with API info",
        "operationId": "root",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RootResponse"
                }
              }
            }
          }
        }
      }
    },
    "/events": {
      "get": {
        "summary": "Get Events",
        "description": "Get sample events for frontend testing",
        "operationId": "get_events",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EventsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/recommend": {
      "post": {
        "summary": "Get Recommendations",
        "description": "Get personalized event recommendations",
        "operationId": "get_recommendations",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecommendationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RecommendationResponse"
                }
              }
            }
          }
        }
      }
    },
    "/interactions": {
      "post": {
        "summary": "Record Interaction",
        "description": "Record user interaction with events",
        "operationId": "record_interaction",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InteractionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InteractionResponse"
                }
              }
            }
          }
        }
      }
    },
    "/search": {
      "post": {
        "summary": "Search Events",
        "description": "Search events by query",
        "operationId": "search_events",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SearchResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "HealthResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "example": "healthy"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-20T15:30:00"
          },
          "service": {
            "type": "string",
            "example": "copenhagen-event-recommender"
          }
        },
        "required": ["status", "timestamp", "service"]
      },
      "RootResponse": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "Copenhagen Event Recommender API"
          },
          "version": {
            "type": "string",
            "example": "1.0.0"
          },
          "docs": {
            "type": "string",
            "example": "/docs"
          },
          "health": {
            "type": "string",
            "example": "/health"
          }
        }
      },
      "Venue": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "example": "Culture Box"
          },
          "address": {
            "type": "string",
            "example": "Kronprinsensgade 54A, 1306 KÃ¸benhavn"
          },
          "neighborhood": {
            "type": "string",
            "example": "Indre By"
          }
        },
        "required": ["name", "address", "neighborhood"]
      },
      "Event": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "event_1"
          },
          "title": {
            "type": "string",
            "example": "Techno Night at Culture Box"
          },
          "description": {
            "type": "string",
            "example": "Underground techno experience in Copenhagen's premier electronic venue"
          },
          "date_time": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-20T22:00:00"
          },
          "venue": {
            "$ref": "#/components/schemas/Venue"
          },
          "price_min": {
            "type": "number",
            "example": 150
          },
          "price_max": {
            "type": "number",
            "example": 200
          },
          "genres": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "example": ["techno", "electronic"]
          },
          "source": {
            "type": "string",
            "example": "manual"
          }
        },
        "required": ["id", "title", "date_time", "venue"]
      },
      "EventsResponse": {
        "type": "object",
        "properties": {
          "events": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Event"
            }
          },
          "total": {
            "type": "integer",
            "example": 2
          }
        },
        "required": ["events", "total"]
      },
      "RecommendationRequest": {
        "type": "object",
        "properties": {
          "user_preferences": {
            "type": "object",
            "properties": {
              "preferred_genres": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "example": ["techno", "house"]
              }
            }
          },
          "location_lat": {
            "type": "number",
            "example": 55.6761
          },
          "location_lon": {
            "type": "number",
            "example": 12.5683
          },
          "num_recommendations": {
            "type": "integer",
            "example": 20
          }
        }
      },
      "Recommendation": {
        "type": "object",
        "properties": {
          "event_id": {
            "type": "string",
            "example": "event_1"
          },
          "score": {
            "type": "number",
            "example": 0.92
          },
          "reasons": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "example": ["Matches your techno preferences", "Popular venue", "Good time slot"]
          },
          "explanation": {
            "type": "string",
            "example": "Recommended because you like electronic music and Culture Box is highly rated"
          }
        },
        "required": ["event_id", "score", "reasons", "explanation"]
      },
      "RecommendationResponse": {
        "type": "object",
        "properties": {
          "recommendations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Recommendation"
            }
          },
          "total": {
            "type": "integer",
            "example": 2
          },
          "request_id": {
            "type": "string",
            "example": "req_1642694400.123"
          }
        },
        "required": ["recommendations", "total", "request_id"]
      },
      "InteractionRequest": {
        "type": "object",
        "properties": {
          "event_id": {
            "type": "string",
            "example": "event_123"
          },
          "interaction_type": {
            "type": "string",
            "enum": ["like", "dislike", "going", "went", "saved"],
            "example": "like"
          },
          "source": {
            "type": "string",
            "example": "feed"
          },
          "position": {
            "type": "integer",
            "example": 3
          }
        },
        "required": ["event_id", "interaction_type"]
      },
      "InteractionResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "interaction_id": {
            "type": "string",
            "example": "int_1642694400.123"
          },
          "recorded_at": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-20T15:30:00"
          }
        },
        "required": ["success", "interaction_id", "recorded_at"]
      },
      "SearchRequest": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "example": "techno tonight"
          },
          "location_lat": {
            "type": "number",
            "example": 55.6761
          },
          "location_lon": {
            "type": "number",
            "example": 12.5683
          }
        },
        "required": ["query"]
      },
      "SearchResult": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "event_1"
          },
          "title": {
            "type": "string",
            "example": "Techno Night at Culture Box"
          },
          "relevance": {
            "type": "number",
            "example": 0.95
          },
          "match_type": {
            "type": "string",
            "example": "title"
          }
        },
        "required": ["id", "title", "relevance"]
      },
      "SearchResponse": {
        "type": "object",
        "properties": {
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SearchResult"
            }
          },
          "query": {
            "type": "string",
            "example": "techno tonight"
          },
          "total": {
            "type": "integer",
            "example": 1
          }
        },
        "required": ["results", "query", "total"]
      }
    }
  }
}